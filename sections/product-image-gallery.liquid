{% schema %}
  {
    "name": "Product Image Gallery",
    "settings": [
    ],
    "presets": [
      {
        "name": "Product Image Gallery",
        "category": "Product"
      }
    ]
  }
{% endschema %}
  
{%- liquid
  assign variant_images = product.images | where: 'attached_to_variant?', true | map: 'src'
  assign products_to_display = product.images.size

  assign columns_mobile_int = 2
  assign show_mobile_slider = false
  if products_to_display > columns_mobile_int
    assign show_mobile_slider = true
  endif

  assign show_desktop_slider = false
  if products_to_display > 4
    assign show_desktop_slider = true
  endif
-%}

<div class="product-media-gallery isolate gradient">
  <slider-component class="slider-mobile-gutter page-width{% if show_desktop_slider %} slider-component-desktop{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
    <ul
      id="ProductMediaSlider"
      class="grid product-media-grid contains-card grid--4-col-desktop grid--2-col-tablet-down{% if show_mobile_slider or show_desktop_slider %} slider{% if show_desktop_slider %} slider--desktop{% endif %}{% if show_mobile_slider %} slider--tablet grid--peek{% endif %}{% endif %}"
      role="list"
      aria-label="{{ 'general.slider.name' | t }}"
    >
      {%- for media in product.media -%}
        <li
          id="Slide-{{ forloop.index }}"
          class="grid__item{% if show_mobile_slider or show_desktop_slider %} slider__slide{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {% if settings.animations_reveal_on_scroll %}
            data-cascade
            style="--animation-order: {{ forloop.index }};"
          {% endif %}
        >
          {% render 'product-media-gallery',
            media: media,
            media_aspect_ratio: 'square',
            image_shape: 'square',
            show_vendor: false,
            section_id: 'product-media'
          %}
        </li>
      {%- endfor -%}
    </ul>

    {%- if show_mobile_slider or show_desktop_slider -%}
      <div class="slider-buttons">
        <button
          type="button"
          class="slider-button slider-button--prev"
          name="previous"
          aria-label="{{ 'general.slider.previous_slide' | t }}"
          aria-controls="ProductMediaSlider"
        >
          <span class="svg-wrapper">
            {{- 'icon-caret.svg' | inline_asset_content -}}
          </span>
        </button>
        <div class="slider-counter caption">
          <span class="slider-counter--current">1</span>
          <span aria-hidden="true"> / </span>
          <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
          <span class="slider-counter--total">{{ products_to_display }}</span>
        </div>
        <button
          type="button"
          class="slider-button slider-button--next"
          name="next"
          aria-label="{{ 'general.slider.next_slide' | t }}"
          aria-controls="ProductMediaSlider"
        >
          <span class="svg-wrapper">
            {{- 'icon-caret.svg' | inline_asset_content -}}
          </span>
        </button>
      </div>
    {%- endif -%}
  </slider-component>
</div>